<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    {include file="common/common_css"}
    <style>
        * {
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .theinput {
            list-style: none;
            outline: none;
            border: 1px solid #eee;
            width: 200px;
            height: 30px;
            line-height: 30px;
        }

        .thebut {
        }
    </style>
    <title>订单修改</title>
</head>

<body>
    <nav class="breadcrumb">
        <i class="Hui-iconfont">&#xe67f;</i> 首页
        <span class="c-gray en">&gt;</span> 服务管理
        <span class="c-gray en">&gt;</span> 订单列表
        <span class="c-gray en">&gt;</span> 订单修改
        <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);"
            title="刷新">
            <i class="Hui-iconfont">&#xe68f;</i>
        </a>
    </nav>
    <div id="step1" style="margin-top: 25px;margin-bottom: 5px;margin-left:30%;padding-left: 10px">
        <div style="width:90px ; display:inline-block">订单号:</div>
        <input style="margin-bottom: 10px" type="text" id="order_id" class="theinput" value="{$order['order_id']}"><br>
        <div style="width:90px ; display:inline-block">订单状态:</div>
        <input style="margin-bottom: 10px" type="text" id="state" class="theinput" value="{$order['state']}"><br>
        <p style="font-size:10px">（上述状态填数字  0为订单取消  1为预约  2为服务中  3为等待支付  4为服务完成  5为评价完成）</p>
        <div style="width:90px ; display:inline-block">支付方式:</div>
        <select class="theinput" name="" id="pay_method">
                <option value="1"{if condition="$order['payment_method'] == 1"}selected{/if} >微信支付</option>
                <option value="2"{if condition="$order['payment_method'] == 2"}selected{/if}>支付宝</option>
                <option value="4"{if condition="$order['payment_method'] == 4"}selected{/if}>现金支付</option>
                <option value="5"{if condition="$order['payment_method'] == 5"}selected{/if}>银行卡支付</option>
                <option value="6"{if condition="$order['payment_method'] == 6"}selected{/if}>其他</option>
                <option value="7"{if condition="$order['payment_method'] == 7"}selected{/if}>美团支付</option>
        </select><br>
        <div style="width:90px ; display:inline-block">支付金额(元):</div>
        <input style="margin-bottom: 10px" type="text" id="cash" class="theinput" value="{$order['pay_amount']}"><br>
        <div style="width:90px ; display:inline-block">上钟时间:</div>
        <input style="margin-bottom: 10px"  type="text" id="appoint_time" class="theinput" value="{$order['appoint_time']}"><br>
        <div style="width:90px ; display:inline-block">顾客数量:</div>
        <input style="margin-bottom: 10px"  type="text" id="num" class="theinput" value="{$order['user_num']}"><br>
        <div style="width:90px ; display:inline-block">备注:</div>
        <input style="margin-bottom: 10px"  type="text" id="note" class="theinput" value="{$order['note']}"><br>

        <div style="width:90px ; display:inline-block"></div>
        <button onclick="done()" class="btn btn-primary" style="margin-top: 6px;width: 90px">订单修改
        </button>
    </div>
    {include file="common/common_script"}
    <!--请在下方写此页面业务相关的脚本-->
    <script type="text/javascript" src="__STATIC__/lib/My97DatePicker/4.8/WdatePicker.js"></script>
    <script type="text/javascript" src="__STATIC__/lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="__STATIC__/lib/laypage/1.2/laypage.js"></script>
    <script type="text/javascript">
    
        function done() {
            phone = $('#phone').val()
            if (phone == "") {
                swal({
                    title: "",
                    text: "手机号不能为空"
                })
                return;
            }
            if ($('#order_id').val() == "") {
                swal({
                    title: "",
                    text: "订单号不能为空"
                })
                return;
            }
            if ( $("#cash").val() == "" ) {
                swal({
                    title: "",
                    text: "金额不能为空"
                })
                return;
            }
            if ($('#state').val() == "") {
                swal({
                    title: "",
                    text: "订单状态不能为空"
                })
                return;
            }
            if ($('#appoint_time').val() == "") {
                swal({
                    title: "",
                    text: "上钟时间不能为空"
                })
                return;
            }
            if ($('#num').val() == "") {
                swal({
                    title: "",
                    text: "顾客数量不能为空"
                })
                return;
            }
            total_price = $('#cash').val();
            $.post("__ROOT__/index.php/api/Consumedorder/update_order", {
                order_id: $('#order_id').val(),
                state: $('#state').val(),
                pay_method: $('#pay_method option:selected').val(),
                cash: $('#cash').val(),
                appoint_time: $('#appoint_time').val(),
                note:$('#note').val()
            }).done((res) => {
                if (res.status == 1) {
                    swal({
                        title: "订单修改成功",
                        type: "success"
                    })
                    parent.location.reload()
                    var index = parent.layer.getFrameIndex(window.name);
                    parent.layer.close(index);
                }
            })
        }
    </script>
</body>

</html>